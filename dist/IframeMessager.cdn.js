(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function r(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(r)?r:String(r)}const n=function(){function e(t){var n,i,o,a=t.role,s=t.iframe;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o={},(i=r(i="_packs"))in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,this.role=a,"parent"===a&&(e.isIframe(s)&&(this.iframe=[s]),s instanceof Array&&(this.iframe=s.filter(e.isIframe)))}var n,i,o;return n=e,o=[{key:"isIframe",value:function(e){return e&&"IFRAME"===e.tagName}}],(i=[{key:"_send",value:function(e,t,r){r.contentWindow.postMessage({type:e,payload:t})}},{key:"_createProcessMessageHandler",value:function(e,t){return function(r){var n=r.data;return n.type===e&&t(n.payload)}}},{key:"on",value:function(e,t){if(e&&t&&t instanceof Function){var r=this._createProcessMessageHandler(e,t);window.addEventListener("message",r);var n=function(){return window.removeEventListener("message",r)},i={type:e,handler:r,removeHandler:n};return this._packs[e]?this._packs[e].push(i):this._packs[e]=[i],n}}},{key:"off",value:function(e){this._packs[e]&&this._packs[e].forEach((function(e){return e.removeHandler()}))}},{key:"emit",value:function(t,r,n){var i=this;if("parent"===this.role){var o=null!=n?n:this.iframe;o&&(e.isIframe(o)&&(o=[o]),o instanceof Array&&o.forEach((function(n){e.isIframe(n)&&i._send(t,r,n)})))}else"children"===this.role&&window.parent.postMessage({type:t,payload:r})}}])&&t(n.prototype,i),o&&t(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();window.IframeMessager=n})();